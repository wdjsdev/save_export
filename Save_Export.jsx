#target Illustrator//Script name: Save Document and Extract PDFs//Author: William Dowling//Creation Date: 10/15/15/*	Saves active document to user's desktop in dated folder with order number as filename.	Saves each artboard as a PDF with artboard name as filename.*///updated 27 May, 2016//added a confirmation function to verify correct collars//updated 15 November, 2016//added cross platform support//updated 23 December, 2016//added condition to ignore any artboard named bag tagfunction container(){	var docRef = app.activeDocument;	var layers = docRef.layers;	var aB = docRef.artboards;	var date = getDate();	var dest = findDest();	//prompt user to confirm they have checked	//for USA Collars	function confirmCollars()	{		var bool = confirm("STOP!!!\nHave you checked the collars?\nIf you're not 100% positive the collars say 'Made in DR' hit cancel and check!");		return bool;	}	var collarsChecked = confirmCollars();	if(!collarsChecked)		return;		function findDest(){				if($.os.match('Windows')){			//PC			var user = $.getenv("USERNAME");			var dest = new Folder("C:\\Users\\" + user + "\\Desktop\\Today's Orders " + date);			return dest.fsName;					} else {			// MAC			var user = $.getenv("USER");			var dest = new Folder("/Volumes/Macintosh HD/Users/" + user + "/Desktop" + "/Today's Orders " + date);			return dest.fsName;		}	}		function getDate(){			var today = new Date();			var dd = today.getDate();			var mm = today.getMonth()+1; //January is 0!			var yyyy = today.getYear();			var yy = yyyy-100;			if(dd<10) {				dd='0'+dd			} 			if(mm<10) {				mm='0'+mm			} 			return mm+'.'+dd+'.'+yy;		}		// dest = "/Volumes/Macintosh HD" + dest + " " + date;	if(!dest.exists){		var newFolder = new Folder(dest);		newFolder.create();	}	if(docRef.name.substring(0,2) == "Un"){		var oN = prompt("Enter Order Number", "1234567");		var fileName = oN;	}	else{		var fileName = docRef.name;	}	var saveFile = new File(dest + "/" + fileName);	if(saveFile.exists){		if(!confirm("This File already exists.. Do you want to overwrite?", false, "Overwrite file?")){			return;		}	}	docRef.saveAs(saveFile);	if(fileName.indexOf(".ai")==-1){		var pdfdest = dest + "/" + fileName + "_PDFs";	}	else{		var pdfdest = dest + "/" + fileName.substring(0,fileName.indexOf(".ai")) + "_PDFs";	}	var pdfFolder = new Folder(pdfdest);	if(!pdfFolder.exists){		pdfFolder.create();	}	else if(pdfFolder.exists){		var removeFiles = pdfFolder.getFiles();		for(var a=0;a<removeFiles.length;a++){			removeFiles[a].remove();		}		pdfFolder.remove();		pdfFolder = new Folder(pdfdest);		pdfFolder.create();//         alert("The PDFs folder for this order already exists.. Please Delete the folder and try again");//         return;			}		//loop artboards to save individual PDFs		var pdfSaveOpts = new PDFSaveOptions();	pdfSaveOpts.preserveEditability = false;	pdfSaveOpts.viewAfterSaving = false;	pdfSaveOpts.compressArt = true;	pdfSaveOpts.optimization = true;//     pdfSaveOpts.preset = "[Smallest File Size]";	var seq = 1;	for(var a=0;a<aB.length;a++){		if(aB[a].name.toLowerCase().indexOf("bag tag")>-1)		{			continue;		}		var range = (a+1).toString();		pdfSaveOpts.artboardRange = range;		var pdfFile = new File(pdfdest + "/" + aB[a].name);		var thisPDF = new File(pdfFile + ".pdf");		if(thisPDF.exists){			thisPDF = new File(pdfFile + " " + seq.toString());			docRef.saveAs(thisPDF, pdfSaveOpts);			seq++;		}		else{			docRef.saveAs(pdfFile, pdfSaveOpts);		}	}}container();